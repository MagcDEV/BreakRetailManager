@page "/inventory"
@using BreakRetailManager.Inventory.Contracts
@implements IAsyncDisposable
@attribute [Authorize(Roles = "Admin,Manager")]
@inject InventoryApiClient InventoryApi
@inject InventoryRealtimeClient Realtime

<PageTitle>Inventory</PageTitle>

<h1>Inventory</h1>

@if (!string.IsNullOrWhiteSpace(statusMessage))
{
    <div class="alert @statusCss alert-dismissible" role="alert">
        @statusMessage
        <button type="button" class="btn-close" @onclick="() => statusMessage = null"></button>
    </div>
}

<ul class="nav nav-tabs mb-4">
    <li class="nav-item">
        <button class="nav-link @(activeTab == Tab.Products ? "active" : "")" @onclick="() => activeTab = Tab.Products">Products</button>
    </li>
    <li class="nav-item">
        <button class="nav-link @(activeTab == Tab.LowStock ? "active" : "")" @onclick="ShowLowStock">Low Stock</button>
    </li>
    <li class="nav-item">
        <button class="nav-link @(activeTab == Tab.Providers ? "active" : "")" @onclick="() => activeTab = Tab.Providers">Providers</button>
    </li>
    <li class="nav-item">
        <button class="nav-link @(activeTab == Tab.AddProduct ? "active" : "")" @onclick="() => activeTab = Tab.AddProduct">+ Product</button>
    </li>
    <li class="nav-item">
        <button class="nav-link @(activeTab == Tab.AddProvider ? "active" : "")" @onclick="() => activeTab = Tab.AddProvider">+ Provider</button>
    </li>
    @if (activeTab == Tab.EditProduct)
    {
        <li class="nav-item">
            <button class="nav-link active">Edit Product</button>
        </li>
    }
    @if (activeTab == Tab.AdjustStock)
    {
        <li class="nav-item">
            <button class="nav-link active">Adjust Stock</button>
        </li>
    }
</ul>

@if (activeTab == Tab.Products)
{
    @if (products.Count == 0)
    {
        <p><em>No products found.</em></p>
    }
    else
    {
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Barcode</th>
                    <th>Name</th>
                    <th>Category</th>
                    <th>Cost</th>
                    <th>Sale Price</th>
                    <th>Stock</th>
                    <th>Reorder Lvl</th>
                    <th>Provider</th>
                    <th>Status</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var product in products)
                {
                    <tr class="@(product.IsLowStock ? "table-warning" : "")">
                        <td>@product.Barcode</td>
                        <td>@product.Name</td>
                        <td>@product.Category</td>
                        <td>@product.CostPrice.ToString("C", arsCulture)</td>
                        <td>@product.SalePrice.ToString("C", arsCulture)</td>
                        <td>@product.StockQuantity</td>
                        <td>@product.ReorderLevel</td>
                        <td>@product.ProviderName</td>
                        <td>
                            @if (product.IsLowStock)
                            {
                                <span class="badge bg-warning text-dark">Low Stock</span>
                            }
                            else
                            {
                                <span class="badge bg-success">In Stock</span>
                            }
                        </td>
                        <td class="text-nowrap">
                            <button class="btn btn-sm btn-outline-primary me-1" @onclick="() => BeginEditProduct(product)">Edit</button>
                            <button class="btn btn-sm btn-outline-secondary" @onclick="() => BeginStockAdjust(product)">Stock</button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
}

@if (activeTab == Tab.LowStock)
{
    @if (lowStockProducts.Count == 0)
    {
        <p><em>No low stock products.</em></p>
    }
    else
    {
        <div class="alert alert-warning">@lowStockProducts.Count product(s) at or below reorder level.</div>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Barcode</th>
                    <th>Name</th>
                    <th>Stock</th>
                    <th>Reorder Lvl</th>
                    <th>Provider</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var product in lowStockProducts)
                {
                    <tr>
                        <td>@product.Barcode</td>
                        <td>@product.Name</td>
                        <td><strong>@product.StockQuantity</strong></td>
                        <td>@product.ReorderLevel</td>
                        <td>@product.ProviderName</td>
                    </tr>
                }
            </tbody>
        </table>
    }
}

@if (activeTab == Tab.Providers)
{
    @if (providers.Count == 0)
    {
        <p><em>No providers found.</em></p>
    }
    else
    {
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Contact</th>
                    <th>Phone</th>
                    <th>Email</th>
                    <th>Address</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var provider in providers)
                {
                    <tr>
                        <td>@provider.Name</td>
                        <td>@provider.ContactName</td>
                        <td>@provider.Phone</td>
                        <td>@provider.Email</td>
                        <td>@provider.Address</td>
                    </tr>
                }
            </tbody>
        </table>
    }
}

@if (activeTab == Tab.AddProduct)
{
    <EditForm Model="productModel" OnValidSubmit="CreateProductAsync" class="mb-4">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="row g-3">
            <div class="col-md-4">
                <label class="form-label">Barcode</label>
                <InputText class="form-control" @bind-Value="productModel.Barcode" />
            </div>
            <div class="col-md-4">
                <label class="form-label">Name</label>
                <InputText class="form-control" @bind-Value="productModel.Name" />
            </div>
            <div class="col-md-4">
                <label class="form-label">Category</label>
                <InputText class="form-control" @bind-Value="productModel.Category" />
            </div>
            <div class="col-md-12">
                <label class="form-label">Description</label>
                <InputText class="form-control" @bind-Value="productModel.Description" />
            </div>
            <div class="col-md-3">
                <label class="form-label">Cost Price</label>
                <InputNumber class="form-control" @bind-Value="productModel.CostPrice" />
            </div>
            <div class="col-md-3">
                <label class="form-label">Sale Price</label>
                <InputNumber class="form-control" @bind-Value="productModel.SalePrice" />
            </div>
            <div class="col-md-4">
                <label class="form-label">Reorder Level</label>
                <InputNumber class="form-control" @bind-Value="productModel.ReorderLevel" />
            </div>
            <div class="col-md-6">
                <label class="form-label">Provider</label>
                <InputSelect class="form-select" @bind-Value="productModel.ProviderId">
                    <option value="">-- Select provider --</option>
                    @foreach (var provider in providers)
                    {
                        <option value="@provider.Id">@provider.Name</option>
                    }
                </InputSelect>
            </div>
            <div class="col-md-6 d-flex align-items-end">
                <button class="btn btn-primary" type="submit" disabled="@isSubmitting">Create Product</button>
            </div>
        </div>
    </EditForm>
}

@if (activeTab == Tab.EditProduct)
{
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="mb-0">Editing: @editModel.Name</h5>
        <button class="btn btn-sm btn-outline-secondary" @onclick="() => activeTab = Tab.Products">Cancel</button>
    </div>

    <EditForm Model="editModel" OnValidSubmit="UpdateProductAsync" class="mb-4">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="row g-3">
            <div class="col-md-4">
                <label class="form-label">Barcode</label>
                <InputText class="form-control" @bind-Value="editModel.Barcode" />
            </div>
            <div class="col-md-4">
                <label class="form-label">Name</label>
                <InputText class="form-control" @bind-Value="editModel.Name" />
            </div>
            <div class="col-md-4">
                <label class="form-label">Category</label>
                <InputText class="form-control" @bind-Value="editModel.Category" />
            </div>
            <div class="col-md-12">
                <label class="form-label">Description</label>
                <InputText class="form-control" @bind-Value="editModel.Description" />
            </div>
            <div class="col-md-3">
                <label class="form-label">Cost Price</label>
                <InputNumber class="form-control" @bind-Value="editModel.CostPrice" />
            </div>
            <div class="col-md-3">
                <label class="form-label">Sale Price</label>
                <InputNumber class="form-control" @bind-Value="editModel.SalePrice" />
            </div>
            <div class="col-md-3">
                <label class="form-label">Reorder Level</label>
                <InputNumber class="form-control" @bind-Value="editModel.ReorderLevel" />
            </div>
            <div class="col-md-3">
                <label class="form-label">Provider</label>
                <InputSelect class="form-select" @bind-Value="editModel.ProviderId">
                    @foreach (var provider in providers)
                    {
                        <option value="@provider.Id">@provider.Name</option>
                    }
                </InputSelect>
            </div>
            <div class="col-md-12">
                <button class="btn btn-primary me-2" type="submit" disabled="@isSubmitting">Save Changes</button>
                <button class="btn btn-outline-secondary" type="button" @onclick="() => activeTab = Tab.Products">Cancel</button>
            </div>
        </div>
    </EditForm>
}

@if (activeTab == Tab.AdjustStock)
{
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="mb-0">üì¶ Stock: @stockProductName</h5>
        <button class="btn btn-sm btn-outline-secondary" @onclick="() => activeTab = Tab.Products">‚Üê Back</button>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="card mb-3">
                <div class="card-header bg-light">
                    <strong>Stock by Location</strong>
                    <span class="badge bg-primary float-end">Total: @locationStocks.Sum(s => s.Quantity)</span>
                </div>
                <div class="card-body p-0">
                    @if (isLoadingStock)
                    {
                        <div class="p-3 text-muted">Loading...</div>
                    }
                    else if (locationStocks.Count == 0)
                    {
                        <div class="p-3 text-muted">No stock assigned to any location yet.</div>
                    }
                    else
                    {
                        <table class="table table-sm mb-0">
                            <thead>
                                <tr>
                                    <th>Location</th>
                                    <th class="text-end">Qty</th>
                                    <th class="text-center">Status</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var stock in locationStocks)
                                {
                                    <tr class="@(stock.IsLowStock ? "table-warning" : "")">
                                        <td>üìç @stock.LocationName</td>
                                        <td class="text-end fw-bold">@stock.Quantity</td>
                                        <td class="text-center">
                                            @if (stock.IsLowStock)
                                            {
                                                <span class="badge bg-warning text-dark">Low</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-success">OK</span>
                                            }
                                        </td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-primary py-0"
                                                    @onclick="() => SelectStockLocation(stock.LocationId, stock.LocationName, stock.Quantity)">
                                                Adjust
                                            </button>
                                        </td>
                                    </tr>
                                }
                                @foreach (var loc in locations.Where(l => !locationStocks.Any(s => s.LocationId == l.Id)))
                                {
                                    <tr class="text-muted">
                                        <td>üìç @loc.Name</td>
                                        <td class="text-end">0</td>
                                        <td class="text-center"><span class="badge bg-secondary">None</span></td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-primary py-0"
                                                    @onclick="() => SelectStockLocation(loc.Id, loc.Name, 0)">
                                                Adjust
                                            </button>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-light">
                    <strong>Adjust Stock</strong>
                </div>
                <div class="card-body">
                    @if (stockLocationId == Guid.Empty)
                    {
                        <div class="text-muted text-center py-3">
                            ‚Üê Select a location to adjust
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-light border mb-3 py-2">
                            üìç <strong>@stockLocationName</strong> ‚Äî Current: <strong>@stockCurrentQuantity</strong> units
                        </div>

                        <div class="row g-3 align-items-end mb-3">
                            <div class="col">
                                <label class="form-label">Quantity to add/remove</label>
                                <input type="number" class="form-control" @bind="stockAdjustQuantity" />
                            </div>
                            <div class="col-auto">
                                <button class="btn btn-success" disabled="@isSubmitting" @onclick="() => ApplyStockAdjustAsync(stockAdjustQuantity)">Apply</button>
                            </div>
                        </div>

                        <div class="d-flex gap-1 flex-wrap">
                            <button class="btn btn-outline-success btn-sm" disabled="@isSubmitting" @onclick="() => QuickAdjustAsync(1)">+1</button>
                            <button class="btn btn-outline-success btn-sm" disabled="@isSubmitting" @onclick="() => QuickAdjustAsync(5)">+5</button>
                            <button class="btn btn-outline-success btn-sm" disabled="@isSubmitting" @onclick="() => QuickAdjustAsync(10)">+10</button>
                            <button class="btn btn-outline-success btn-sm" disabled="@isSubmitting" @onclick="() => QuickAdjustAsync(50)">+50</button>
                            <button class="btn btn-outline-danger btn-sm" disabled="@isSubmitting" @onclick="() => QuickAdjustAsync(-1)">-1</button>
                            <button class="btn btn-outline-danger btn-sm" disabled="@isSubmitting" @onclick="() => QuickAdjustAsync(-5)">-5</button>
                            <button class="btn btn-outline-danger btn-sm" disabled="@isSubmitting" @onclick="() => QuickAdjustAsync(-10)">-10</button>
                            <button class="btn btn-outline-danger btn-sm" disabled="@isSubmitting" @onclick="() => QuickAdjustAsync(-50)">-50</button>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
}

@if (activeTab == Tab.AddProvider)
{
    <EditForm Model="providerModel" OnValidSubmit="CreateProviderAsync" class="mb-4">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label">Name</label>
                <InputText class="form-control" @bind-Value="providerModel.Name" />
            </div>
            <div class="col-md-6">
                <label class="form-label">Contact Name</label>
                <InputText class="form-control" @bind-Value="providerModel.ContactName" />
            </div>
            <div class="col-md-4">
                <label class="form-label">Phone</label>
                <InputText class="form-control" @bind-Value="providerModel.Phone" />
            </div>
            <div class="col-md-4">
                <label class="form-label">Email</label>
                <InputText class="form-control" @bind-Value="providerModel.Email" />
            </div>
            <div class="col-md-4">
                <label class="form-label">Address</label>
                <InputText class="form-control" @bind-Value="providerModel.Address" />
            </div>
            <div class="col-md-12">
                <button class="btn btn-primary" type="submit" disabled="@isSubmitting">Create Provider</button>
            </div>
        </div>
    </EditForm>
}

@code {
    private static readonly System.Globalization.CultureInfo arsCulture = new("es-AR");

    private readonly List<ProductDto> products = new();
    private readonly List<ProductDto> lowStockProducts = new();
    private readonly List<ProviderDto> providers = new();
    private readonly List<LocationDto> locations = new();
    private readonly CreateProductModel productModel = new();
    private readonly EditProductModel editModel = new();
    private readonly CreateProviderModel providerModel = new();

    private Tab activeTab = Tab.Products;
    private bool isSubmitting;
    private string? statusMessage;
    private string statusCss = "alert-info";

    // Stock adjustment state
    private Guid stockProductId;
    private string stockProductName = string.Empty;
    private int stockCurrentQuantity;
    private int stockAdjustQuantity;
    private Guid stockLocationId;
    private string stockLocationName = string.Empty;
    private readonly List<LocationStockDto> locationStocks = new();
    private bool isLoadingStock;
    private CancellationTokenSource? realtimeRefreshDebounceCts;
    private readonly TimeSpan realtimeRefreshDebounceDelay = TimeSpan.FromMilliseconds(300);

    protected override async Task OnInitializedAsync()
    {
        await LoadDataAsync();
        Realtime.StockChanged += HandleRealtimeStockChangedAsync;
        await Realtime.StartAsync();
    }

    private async Task LoadDataAsync()
    {
        products.Clear();
        products.AddRange(await InventoryApi.GetProductsAsync());

        providers.Clear();
        providers.AddRange(await InventoryApi.GetProvidersAsync());

        locations.Clear();
        locations.AddRange(await InventoryApi.GetLocationsAsync());
    }

    private async Task ShowLowStock()
    {
        activeTab = Tab.LowStock;
        lowStockProducts.Clear();
        lowStockProducts.AddRange(await InventoryApi.GetLowStockProductsAsync());
    }

    private void BeginEditProduct(ProductDto product)
    {
        editModel.Id = product.Id;
        editModel.Barcode = product.Barcode;
        editModel.Name = product.Name;
        editModel.Description = product.Description;
        editModel.Category = product.Category;
        editModel.CostPrice = product.CostPrice;
        editModel.SalePrice = product.SalePrice;
        editModel.ReorderLevel = product.ReorderLevel;
        editModel.ProviderId = product.ProviderId;
        activeTab = Tab.EditProduct;
    }

    private async Task BeginStockAdjust(ProductDto product)
    {
        stockProductId = product.Id;
        stockProductName = product.Name;
        stockCurrentQuantity = 0;
        stockAdjustQuantity = 0;
        stockLocationId = Guid.Empty;
        stockLocationName = string.Empty;
        activeTab = Tab.AdjustStock;

        await LoadLocationStocksAsync();
    }

    private async Task LoadLocationStocksAsync()
    {
        isLoadingStock = true;
        locationStocks.Clear();

        foreach (var loc in locations)
        {
            var stocks = await InventoryApi.GetLocationStockAsync(loc.Id);
            var match = stocks.FirstOrDefault(s => s.ProductId == stockProductId);
            if (match is not null)
            {
                locationStocks.Add(match);
            }
        }

        isLoadingStock = false;
    }

    private void SelectStockLocation(Guid locationId, string locationName, int currentQty)
    {
        stockLocationId = locationId;
        stockLocationName = locationName;
        stockCurrentQuantity = currentQty;
        stockAdjustQuantity = 0;
    }

    private async Task UpdateProductAsync()
    {
        isSubmitting = true;
        statusMessage = null;

        var request = new UpdateProductRequest(
            editModel.Barcode,
            editModel.Name,
            editModel.Description,
            editModel.Category,
            editModel.CostPrice,
            editModel.SalePrice,
            editModel.ReorderLevel,
            editModel.ProviderId);

        var updated = await InventoryApi.UpdateProductAsync(editModel.Id, request);
        if (updated is not null)
        {
            statusMessage = $"Product '{updated.Name}' updated.";
            statusCss = "alert-success";
            await LoadDataAsync();
            activeTab = Tab.Products;
        }
        else
        {
            statusMessage = "Failed to update product.";
            statusCss = "alert-danger";
        }

        isSubmitting = false;
    }

    private async Task ApplyStockAdjustAsync(int quantity)
    {
        if (stockLocationId == Guid.Empty) return;

        isSubmitting = true;
        statusMessage = null;

        var result = await InventoryApi.UpdateLocationStockAsync(stockLocationId, stockProductId, quantity);
        if (result is not null)
        {
            stockCurrentQuantity = result.Quantity;
            stockAdjustQuantity = 0;
            statusMessage = $"Stock for '{stockProductName}' at {stockLocationName} adjusted by {(quantity >= 0 ? "+" : "")}{quantity}. New stock: {result.Quantity}.";
            statusCss = "alert-success";
            await LoadDataAsync();
            await LoadLocationStocksAsync();
        }
        else
        {
            statusMessage = "Failed to adjust location stock.";
            statusCss = "alert-danger";
        }

        isSubmitting = false;
    }

    private async Task QuickAdjustAsync(int quantity)
    {
        stockAdjustQuantity = quantity;
        await ApplyStockAdjustAsync(quantity);
    }

    private async Task CreateProductAsync()
    {
        isSubmitting = true;
        statusMessage = null;

        var request = new CreateProductRequest(
            productModel.Barcode,
            productModel.Name,
            productModel.Description,
            productModel.Category,
            productModel.CostPrice,
            productModel.SalePrice,
            productModel.ReorderLevel,
            productModel.ProviderId);

        var created = await InventoryApi.CreateProductAsync(request);
        if (created is not null)
        {
            statusMessage = $"Product '{created.Name}' created.";
            statusCss = "alert-success";
            productModel.Reset();
            await LoadDataAsync();
            activeTab = Tab.Products;
        }
        else
        {
            statusMessage = "Failed to create product.";
            statusCss = "alert-danger";
        }

        isSubmitting = false;
    }

    private async Task CreateProviderAsync()
    {
        isSubmitting = true;
        statusMessage = null;

        var request = new CreateProviderRequest(
            providerModel.Name,
            providerModel.ContactName,
            providerModel.Phone,
            providerModel.Email,
            providerModel.Address);

        var created = await InventoryApi.CreateProviderAsync(request);
        if (created is not null)
        {
            statusMessage = $"Provider '{created.Name}' created.";
            statusCss = "alert-success";
            providerModel.Reset();
            await LoadDataAsync();
            activeTab = Tab.Providers;
        }
        else
        {
            statusMessage = "Failed to create provider.";
            statusCss = "alert-danger";
        }

        isSubmitting = false;
    }

    private Task HandleRealtimeStockChangedAsync(InventoryStockChangedEvent _)
    {
        ScheduleDebouncedRealtimeRefresh();
        return Task.CompletedTask;
    }

    private void ScheduleDebouncedRealtimeRefresh()
    {
        realtimeRefreshDebounceCts?.Cancel();
        realtimeRefreshDebounceCts?.Dispose();

        var cts = new CancellationTokenSource();
        realtimeRefreshDebounceCts = cts;

        _ = RunDebouncedRealtimeRefreshAsync(cts.Token);
    }

    private async Task RunDebouncedRealtimeRefreshAsync(CancellationToken cancellationToken)
    {
        try
        {
            await Task.Delay(realtimeRefreshDebounceDelay, cancellationToken);

            await InvokeAsync(async () =>
            {
                await LoadDataAsync();

                if (activeTab == Tab.LowStock)
                {
                    lowStockProducts.Clear();
                    lowStockProducts.AddRange(await InventoryApi.GetLowStockProductsAsync(cancellationToken));
                }

                if (activeTab == Tab.AdjustStock && stockProductId != Guid.Empty)
                {
                    await LoadLocationStocksAsync();
                    var selectedStock = locationStocks.FirstOrDefault(stock => stock.LocationId == stockLocationId);
                    if (selectedStock is not null)
                    {
                        stockCurrentQuantity = selectedStock.Quantity;
                    }
                }

                StateHasChanged();
            });
        }
        catch (OperationCanceledException)
        {
        }
    }

    public async ValueTask DisposeAsync()
    {
        realtimeRefreshDebounceCts?.Cancel();
        realtimeRefreshDebounceCts?.Dispose();

        Realtime.StockChanged -= HandleRealtimeStockChangedAsync;
        await Realtime.DisposeAsync();
    }

    private enum Tab { Products, LowStock, Providers, AddProduct, AddProvider, EditProduct, AdjustStock }

    private sealed class CreateProductModel
    {
        [Required] [StringLength(100)]
        public string Barcode { get; set; } = string.Empty;

        [Required] [StringLength(200)]
        public string Name { get; set; } = string.Empty;

        [StringLength(1000)]
        public string Description { get; set; } = string.Empty;

        [StringLength(100)]
        public string Category { get; set; } = string.Empty;

        [Range(typeof(decimal), "0", "1000000")]
        public decimal CostPrice { get; set; }

        [Range(typeof(decimal), "0.01", "1000000")]
        public decimal SalePrice { get; set; }

        [Range(0, 1000000)]
        public int ReorderLevel { get; set; }

        [Required]
        public Guid ProviderId { get; set; }

        public void Reset()
        {
            Barcode = string.Empty;
            Name = string.Empty;
            Description = string.Empty;
            Category = string.Empty;
            CostPrice = 0;
            SalePrice = 0;
            ReorderLevel = 0;
            ProviderId = Guid.Empty;
        }
    }

    private sealed class EditProductModel
    {
        public Guid Id { get; set; }

        [Required] [StringLength(100)]
        public string Barcode { get; set; } = string.Empty;

        [Required] [StringLength(200)]
        public string Name { get; set; } = string.Empty;

        [StringLength(1000)]
        public string Description { get; set; } = string.Empty;

        [StringLength(100)]
        public string Category { get; set; } = string.Empty;

        [Range(typeof(decimal), "0", "1000000")]
        public decimal CostPrice { get; set; }

        [Range(typeof(decimal), "0.01", "1000000")]
        public decimal SalePrice { get; set; }

        [Range(0, 1000000)]
        public int ReorderLevel { get; set; }

        [Required]
        public Guid ProviderId { get; set; }
    }

    private sealed class CreateProviderModel
    {
        [Required] [StringLength(200)]
        public string Name { get; set; } = string.Empty;

        [StringLength(200)]
        public string ContactName { get; set; } = string.Empty;

        [StringLength(50)]
        public string Phone { get; set; } = string.Empty;

        [StringLength(200)]
        public string Email { get; set; } = string.Empty;

        [StringLength(500)]
        public string Address { get; set; } = string.Empty;

        public void Reset()
        {
            Name = string.Empty;
            ContactName = string.Empty;
            Phone = string.Empty;
            Email = string.Empty;
            Address = string.Empty;
        }
    }
}
